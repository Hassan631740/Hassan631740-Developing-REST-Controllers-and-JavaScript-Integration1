<!DOCTYPE html>
<html >
<head>
    <meta charset="UTF-8">
    <title>REST API Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .api-section {
            margin-bottom: 2rem;
            padding: 1rem;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
        }
        .response-area {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-top: 1rem;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="mb-4">
            <i class="fas fa-code me-2"></i>REST API Test Page
        </h1>
        
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            This page demonstrates the REST API endpoints for user and role management.
        </div>

        <!-- Users API Section -->
        <div class="api-section">
            <h3><i class="fas fa-users me-2"></i>Users API</h3>
            
            <div class="row">
                <div class="col-md-6">
                    <h5>Get All Users</h5>
                    <button class="btn btn-primary" onclick="testGetUsers()">
                        <i class="fas fa-download me-1"></i>GET /api/users
                    </button>
                </div>
                <div class="col-md-6">
                    <h5>Get User by ID</h5>
                    <div class="input-group">
                        <input type="number" id="userId" class="form-control" placeholder="User ID">
                        <button class="btn btn-info" onclick="testGetUserById()">
                            <i class="fas fa-search me-1"></i>GET
                        </button>
                    </div>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-md-6">
                    <h5>Create User</h5>
                    <button class="btn btn-success" onclick="testCreateUser()">
                        <i class="fas fa-plus me-1"></i>POST /api/users
                    </button>
                </div>
                <div class="col-md-6">
                    <h5>Update User</h5>
                    <div class="input-group">
                        <input type="number" id="updateUserId" class="form-control" placeholder="User ID">
                        <button class="btn btn-warning" onclick="testUpdateUser()">
                            <i class="fas fa-edit me-1"></i>PUT
                        </button>
                    </div>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-md-6">
                    <h5>Delete User</h5>
                    <div class="input-group">
                        <input type="number" id="deleteUserId" class="form-control" placeholder="User ID">
                        <button class="btn btn-danger" onclick="testDeleteUser()">
                            <i class="fas fa-trash me-1"></i>DELETE
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Roles API Section -->
        <div class="api-section">
            <h3><i class="fas fa-user-tag me-2"></i>Roles API</h3>
            
            <div class="row">
                <div class="col-md-6">
                    <h5>Get All Roles</h5>
                    <button class="btn btn-primary" onclick="testGetRoles()">
                        <i class="fas fa-download me-1"></i>GET /api/roles
                    </button>
                </div>
                <div class="col-md-6">
                    <h5>Get Role by ID</h5>
                    <div class="input-group">
                        <input type="number" id="roleId" class="form-control" placeholder="Role ID">
                        <button class="btn btn-info" onclick="testGetRoleById()">
                            <i class="fas fa-search me-1"></i>GET
                        </button>
                    </div>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-md-6">
                    <h5>Create Role</h5>
                    <button class="btn btn-success" onclick="testCreateRole()">
                        <i class="fas fa-plus me-1"></i>POST /api/roles
                    </button>
                </div>
                <div class="col-md-6">
                    <h5>Update Role</h5>
                    <div class="input-group">
                        <input type="number" id="updateRoleId" class="form-control" placeholder="Role ID">
                        <button class="btn btn-warning" onclick="testUpdateRole()">
                            <i class="fas fa-edit me-1"></i>PUT
                        </button>
                    </div>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-md-6">
                    <h5>Delete Role</h5>
                    <div class="input-group">
                        <input type="number" id="deleteRoleId" class="form-control" placeholder="Role ID">
                        <button class="btn btn-danger" onclick="testDeleteRole()">
                            <i class="fas fa-trash me-1"></i>DELETE
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Response Area -->
        <div class="api-section">
            <h3><i class="fas fa-terminal me-2"></i>API Response</h3>
            <div id="responseArea" class="response-area">Click any API button above to see the response...</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/api.js"></script>
    
    <script>
        function displayResponse(data) {
            const responseArea = document.getElementById('responseArea');
            responseArea.textContent = JSON.stringify(data, null, 2);
        }

        function displayError(error) {
            const responseArea = document.getElementById('responseArea');
            responseArea.textContent = `Error: ${error.message}`;
        }

        // User API Tests
        async function testGetUsers() {
            try {
                const response = await apiClient.getAllUsers();
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testGetUserById() {
            const userId = document.getElementById('userId').value;
            if (!userId) {
                alert('Please enter a User ID');
                return;
            }
            try {
                const response = await apiClient.getUserById(userId);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testCreateUser() {
            const userData = {
                firstName: "Test",
                lastName: "User",
                age: 25,
                email: "test@example.com",
                password: "password123",
                roles: ["USER"]
            };
            try {
                const response = await apiClient.createUser(userData);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testUpdateUser() {
            const userId = document.getElementById('updateUserId').value;
            if (!userId) {
                alert('Please enter a User ID');
                return;
            }
            const userData = {
                firstName: "Updated",
                lastName: "User",
                age: 30,
                email: "updated@example.com",
                password: "newpassword123",
                roles: ["ADMIN"]
            };
            try {
                const response = await apiClient.updateUser(userId, userData);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testDeleteUser() {
            const userId = document.getElementById('deleteUserId').value;
            if (!userId) {
                alert('Please enter a User ID');
                return;
            }
            if (!confirm('Are you sure you want to delete this user?')) {
                return;
            }
            try {
                const response = await apiClient.deleteUser(userId);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        // Role API Tests
        async function testGetRoles() {
            try {
                const response = await apiClient.getAllRoles();
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testGetRoleById() {
            const roleId = document.getElementById('roleId').value;
            if (!roleId) {
                alert('Please enter a Role ID');
                return;
            }
            try {
                const response = await apiClient.getRoleById(roleId);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testCreateRole() {
            const roleData = {
                name: "TEST_ROLE"
            };
            try {
                const response = await apiClient.createRole(roleData);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testUpdateRole() {
            const roleId = document.getElementById('updateRoleId').value;
            if (!roleId) {
                alert('Please enter a Role ID');
                return;
            }
            const roleData = {
                name: "UPDATED_ROLE"
            };
            try {
                const response = await apiClient.updateRole(roleId, roleData);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }

        async function testDeleteRole() {
            const roleId = document.getElementById('deleteRoleId').value;
            if (!roleId) {
                alert('Please enter a Role ID');
                return;
            }
            if (!confirm('Are you sure you want to delete this role?')) {
                return;
            }
            try {
                const response = await apiClient.deleteRole(roleId);
                displayResponse(response);
            } catch (error) {
                displayError(error);
            }
        }
    </script>
</body>
</html> 